import{i as _,k as v,w as g,x as P,r as O,j as e,C as t,m as E,K as q}from"./index-0b81dd7c.js";import{c as S,a as l,d as o}from"./index.esm-a5665108.js";import{U as V}from"./Uploader-8928e4d9.js";const B=S().shape({clientName:l().required("Поле обязательно для заполнения"),clientPhone:l().required("Поле обязательно для заполнения").matches(/^[\d+]+$/,"Телефон должен содержать только цифры"),contractNumber:l().required("Поле обязательно для заполнения"),comment:l(),barterType:l().required("Поле обязательно для заполнения"),clientOffer:l().required("Поле обязательно для заполнения"),companyOffer:l().required("Поле обязательно для заполнения"),clientPayment:o().required("Поле обязательно для заполнения").typeError("Поле обязательно для заполнения"),companyPayment:o().required("Поле обязательно для заполнения").typeError("Поле обязательно для заполнения")});function $({setUpdateStatus:d}){const p=_(),u=v(g),{handleSubmit:f,control:r,formState:x,setError:h,setValue:T,reset:j}=P(),{errors:s}=x,[c,i]=O.useState({}),y=async a=>{try{await B.validate(a,{abortEarly:!1});const m={apartment:u,clientName:a.clientName,clientPhone:a.clientPhone,contractNumber:a.contractNumber,contractDocument:c,barter:{barterType:a.barterType,clientOffer:a.clientOffer,companyOffer:a.companyOffer,clientPayment:a.clientPayment,companyPayment:a.companyPayment},comment:a.comment};p(q(m)).unwrap().then(n=>{(n==null?void 0:n.status)===200&&(N(),i({}),j(),b()),console.log(n)})}catch(m){m.inner.forEach(n=>{h(n.path,{type:"manual",message:n.message})})}},b=()=>{const a=document.getElementById("close-barter-form-btn");a&&a.click()},N=()=>{d("1")};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"modal fade modal-for-admin",id:"formBarter",tabIndex:-1,"aria-labelledby":"formBarter","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsx("div",{className:"modal-content",children:e.jsxs("div",{className:"modal-body modal-call__body",children:[e.jsxs("form",{className:"modal-call__form",onSubmit:f(y),children:[e.jsx("h4",{className:"modal-call__title",children:"Бартер"}),e.jsxs("div",{className:"modal-for-admin__forms",children:[e.jsxs("div",{className:"modal-call__side",children:[e.jsx("p",{className:"modal-for-admin__title-side",children:"Данные клиента"}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"clientName",control:r,defaultValue:"",render:({field:a})=>e.jsx("input",{placeholder:"ФИО клиента*",...a})}),s.clientName&&e.jsx("p",{children:s.clientName.message})]}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"clientPhone",control:r,defaultValue:"",render:({field:a})=>e.jsx("input",{placeholder:"Телефон клиента*",...a})}),s.clientPhone&&e.jsx("p",{children:s.clientPhone.message})]}),e.jsx("p",{className:"modal-for-admin__title-side",style:{marginTop:"40px"},children:"Предложение для обмена"}),e.jsx("div",{className:"form-item",children:e.jsx(t,{name:"barterType",control:r,render:({field:a})=>e.jsx("input",{placeholder:"Тип бартера",...a})})}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"clientOffer",control:r,render:({field:a})=>e.jsx("input",{placeholder:"Описание предложения клиента*",...a})}),s.clientOffer&&e.jsx("p",{children:s.clientOffer.message})]}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"companyOffer",control:r,render:({field:a})=>e.jsx("input",{placeholder:"Описание предложения компании*",...a})}),s.companyOffer&&e.jsx("p",{children:s.companyOffer.message})]}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"clientPayment",control:r,defaultValue:"",render:({field:a})=>e.jsx("input",{placeholder:"Сумма внесенная клиентом",...a,type:"number"})}),s.clientPayment&&e.jsx("p",{children:s.clientPayment.message})]})]}),e.jsxs("div",{className:"modal-call__side",children:[e.jsx("p",{className:"modal-for-admin__title-side",children:"Параметры"}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"companyPayment",control:r,defaultValue:"",render:({field:a})=>e.jsx("input",{placeholder:"Сумма внесенная компанией",...a,type:"number"})}),s.companyPayment&&e.jsx("p",{children:s.companyPayment.message})]}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"contractNumber",control:r,defaultValue:"",render:({field:a})=>e.jsx("input",{placeholder:"Номер договора*",...a,type:"text"})}),s.contractNumber&&e.jsx("p",{children:s.contractNumber.message})]}),e.jsxs("div",{className:"form-item",children:[e.jsx(t,{name:"comment",control:r,defaultValue:"",render:({field:a})=>e.jsx("textarea",{placeholder:"Комментарий",...a})}),s.comment&&e.jsx("p",{children:s.comment.message})]}),e.jsxs("div",{className:"modal-admin__controls",children:[e.jsx(V,{file:c,setFile:i}),e.jsx("button",{type:"submit",className:"form__btn-submit link-brown",children:"Сохранить"}),e.jsx("button",{type:"button",className:"form__btn-undoing","data-bs-dismiss":"modal","aria-label":"Закрыть",children:"Отмена"})]})]})]})]}),e.jsx("button",{type:"button",id:"close-barter-form-btn",className:"modal-call__btn-close","data-bs-dismiss":"modal","aria-label":"Закрыть",value:"Send",children:e.jsx("img",{src:E,alt:"Закрыть"})})]})})})})})}export{$ as default};
